/*podTemplate(label: 'graglepod', containers: [
    containerTemplate(name: 'git', image: 'alpine/git', ttyEnabled: true, command: 'cat'),
    containerTemplate(name: 'gradle', image: 'gradle', command: 'cat', ttyEnabled: true),
    containerTemplate(name: 'docker', image: 'docker', command: 'cat', ttyEnabled: true)
  ],
  
  volumes: [
    hostPathVolume(mountPath: '/var/run/docker.sock', hostPath: '/var/run/docker.sock')
  ] 
  )  
node('gradlepod') {
    /* 
    stage('clone gradle project repo'){
        container('git'){
            sh """
                git clone https://github.com/ronlevy1211/gradle-project.git
                """
        }
    }
    stage('Build Artifact'){
        container('gradle'){
            sh """
                gradle -v
                """
        }
    }
    stage('Push to DockerHub'){
        container('docker'){
            sh """
                docker build -t ronlevy1211/hello-world
                docker push ronlevy1211/hello-world
                """
        }
    }
}*/
podTemplate(label: 'testpod',containers: [
    containerTemplate(name: 'git', image: 'alpine/git', ttyEnabled: true, command: 'cat'),
    containerTemplate(name: 'gradle', image: 'gradle', ttyEnabled: true, command: 'cat'),
    containerTemplate(name: 'centos', image: 'centos:7', ttyEnabled: true, command: 'cat'),
  ])
  {
node('testpod') {
    stage('Clone project'){
        container('git'){
            sh """
                git clone https://github.com/ronlevy1211/gradle-project.git
                """
        }
    }
    stage('Build'){
        container('gradle'){
            sh """
                cd gradle-project
                gradle build
                """
        }
    }
    stage('Test'){
        container('centos'){
            sh """
                ls -l
                find / -name *.war
                """
        }
    }
}
}
